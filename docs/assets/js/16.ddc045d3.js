(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{705:function(t,s,a){"use strict";a.r(s);var e=a(62),i=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"最佳实践"}},[t._v("最佳实践 "),s("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践"}},[t._v("#")])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("我们以常用的MQTT协议为例，介绍如何使用Iot-DC3平台。")]),t._v(" "),s("p",[t._v("看完你将了解到")]),t._v(" "),s("ul",[s("li",[t._v("驱动接入")]),t._v(" "),s("li",[t._v("设备接入")]),t._v(" "),s("li",[t._v("数据采集")])])]),t._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[t._v("前置")]),t._v(" "),s("p",[t._v("在开始之前,请确保以下前置设施是否已经搭建好")]),t._v(" "),s("ul",[s("li",[t._v("基础设施\n"),s("ul",{staticClass:"contains-task-list"},[s("li",{staticClass:"task-list-item"},[s("input",{staticClass:"task-list-item-checkbox",attrs:{checked:"",disabled:"",type:"checkbox"}}),t._v(" Mysql")]),t._v(" "),s("li",{staticClass:"task-list-item"},[s("input",{staticClass:"task-list-item-checkbox",attrs:{checked:"",disabled:"",type:"checkbox"}}),t._v(" Redis")]),t._v(" "),s("li",{staticClass:"task-list-item"},[s("input",{staticClass:"task-list-item-checkbox",attrs:{checked:"",disabled:"",type:"checkbox"}}),t._v(" RabbitMQ")]),t._v(" "),s("li",{staticClass:"task-list-item"},[s("input",{staticClass:"task-list-item-checkbox",attrs:{checked:"",disabled:"",type:"checkbox"}}),t._v(" MongoDB")]),t._v(" "),s("li",{staticClass:"task-list-item"},[s("input",{staticClass:"task-list-item-checkbox",attrs:{checked:"",disabled:"",type:"checkbox"}}),t._v(" Nacos")])])]),t._v(" "),s("li",[t._v("基础服务\n"),s("ul",{staticClass:"contains-task-list"},[s("li",{staticClass:"task-list-item"},[s("input",{staticClass:"task-list-item-checkbox",attrs:{checked:"",disabled:"",type:"checkbox"}}),t._v(" dc3-center-auth")]),t._v(" "),s("li",{staticClass:"task-list-item"},[s("input",{staticClass:"task-list-item-checkbox",attrs:{checked:"",disabled:"",type:"checkbox"}}),t._v(" dc3-center-data")]),t._v(" "),s("li",{staticClass:"task-list-item"},[s("input",{staticClass:"task-list-item-checkbox",attrs:{checked:"",disabled:"",type:"checkbox"}}),t._v(" dc3-center-manger")]),t._v(" "),s("li",{staticClass:"task-list-item"},[s("input",{staticClass:"task-list-item-checkbox",attrs:{checked:"",disabled:"",type:"checkbox"}}),t._v(" dc3-center-gateway")]),t._v(" "),s("li",{staticClass:"task-list-item"},[s("input",{staticClass:"task-list-item-checkbox",attrs:{checked:"",disabled:"",type:"checkbox"}}),t._v(" WebUI")])])])]),t._v(" "),s("p",[t._v("如果没有,请参考")]),t._v(" "),s("ul",[s("li",[s("RouterLink",{attrs:{to:"/docs/code/3-idea-start.html"}},[s("strong",[t._v("构建基础服务&设施")])])],1),t._v(" "),s("li",[s("RouterLink",{attrs:{to:"/docs/code/4-web-ui.html"}},[s("strong",[t._v("构建 IoT DC3 Web UI")])])],1)])]),t._v(" "),s("h2",{attrs:{id:"启动驱动"}},[t._v("启动驱动 "),s("a",{staticClass:"header-anchor",attrs:{href:"#启动驱动"}},[t._v("#")])]),t._v(" "),s("a-alert",{attrs:{showIcon:"",type:"warning",message:"平台使用的RabbitMQ的mqtt插件,如果你使用的是EMQX,请自行替换对应配置"}}),t._v(" "),s("blockquote",[s("p",[t._v("驱动位置: dc3-driver/dc3-driver-mqtt")]),t._v(" "),s("p",[t._v("相关配置: "),s("RouterLink",{attrs:{to:"/config/#mqtt"}},[t._v("dc3-driver-mqtt.yml")])],1),t._v(" "),s("p",[t._v("主要配置:")]),t._v(" "),s("ul",[s("li",[t._v("driver.mqtt.url: ${MQTT_BROKER_URL:ssl://dc3-rabbitmq:8883} # MQTT Broker URL")]),t._v(" "),s("li",[t._v("auth-type: X509 # 认证方式")]),t._v(" "),s("li",[t._v("username: dc3 # 用户名")]),t._v(" "),s("li",[t._v("password: dc3 # 密码")])]),t._v(" "),s("p",[s("strong",[t._v("注意")]),t._v(": 以上配置是开启MQTT SSL认证的配置,如果你的MQTT Broker没有开启SSL认证,请将"),s("code",[t._v("auth-type")]),t._v("设置为"),s("code",[t._v("NONE")]),t._v("或者注释掉,同时将url设置为普通的"),s("code",[t._v("tcp://dc3-rabbitmq:1883")])])]),t._v(" "),s("p",[t._v("启动成功后在WebUI中可以看到驱动已在线")]),t._v(" "),s("p",[s("img",{attrs:{src:"/assets/images/operation/code/02e367ee-19ea-4e03-846e-e7675a3dbf1e.png",alt:"驱动在线"}})]),t._v(" "),s("h2",{attrs:{id:"添加设备"}},[t._v("添加设备 "),s("a",{staticClass:"header-anchor",attrs:{href:"#添加设备"}},[t._v("#")])]),t._v(" "),s("h3",{attrs:{id:"添加位号模板"}},[t._v("添加位号模板 "),s("a",{staticClass:"header-anchor",attrs:{href:"#添加位号模板"}},[t._v("#")])]),t._v(" "),s("ol",[s("li",[t._v("点击顶部导航栏的"),s("code",[t._v("模板")])]),t._v(" "),s("li",[t._v("点击新增"),s("code",[t._v("模板")])]),t._v(" "),s("li",[t._v("填写模板名称")]),t._v(" "),s("li",[t._v("编辑新增的模板")]),t._v(" "),s("li",[t._v("下一步->模板位号配置")]),t._v(" "),s("li",[t._v("点击新增位号,填写对应配置")])]),t._v(" "),s("p",[s("img",{attrs:{src:"/assets/images/operation/code/410ae5ee-4311-4ef6-9678-e22614ee8010.png",alt:"模板列表"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"/assets/images/operation/code/e0f86efa-bb51-4a0e-a5d0-4411dccf46ce.png",alt:"模板位号配置"}})]),t._v(" "),s("h3",{attrs:{id:"新增设备"}},[t._v("新增设备 "),s("a",{staticClass:"header-anchor",attrs:{href:"#新增设备"}},[t._v("#")])]),t._v(" "),s("ol",[s("li",[t._v("点击顶部导航栏的"),s("code",[t._v("设备")])]),t._v(" "),s("li",[t._v("点击新增"),s("code",[t._v("设备")])]),t._v(" "),s("li",[t._v("填写设备名称")]),t._v(" "),s("li",[t._v("选择设备模板(上面新增的模板)")]),t._v(" "),s("li",[t._v("选择驱动(上面启动的驱动)")]),t._v(" "),s("li",[t._v("确定保存")])]),t._v(" "),s("a-alert",{attrs:{showIcon:"",type:"warning",message:"当前实践仅展示如何读取设备数据,下发设备指令本篇不讲解参考驱动具体文档"}}),t._v(" "),s("h2",{attrs:{id:"模拟设备采集数据"}},[t._v("模拟设备采集数据 "),s("a",{staticClass:"header-anchor",attrs:{href:"#模拟设备采集数据"}},[t._v("#")])]),t._v(" "),s("h3",{attrs:{id:"安装mqttx客户端"}},[t._v("安装MQTTX客户端 "),s("a",{staticClass:"header-anchor",attrs:{href:"#安装mqttx客户端"}},[t._v("#")])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://mqttx.app/zh",target:"_blank",rel:"noopener noreferrer"}},[t._v("点击安装"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"连接mqtt"}},[t._v("连接MQTT "),s("a",{staticClass:"header-anchor",attrs:{href:"#连接mqtt"}},[t._v("#")])]),t._v(" "),s("p",[s("img",{attrs:{src:"/assets/images/operation/code/WX20230417-143936@2x.png",alt:"连接MQTT"}})]),t._v(" "),s("h3",{attrs:{id:"添加订阅"}},[t._v("添加订阅 "),s("a",{staticClass:"header-anchor",attrs:{href:"#添加订阅"}},[t._v("#")])]),t._v(" "),s("blockquote",[s("p",[t._v("dc3/default/dc3-driver-mqtt/data")])]),t._v(" "),s("h3",{attrs:{id:"发送数据"}},[t._v("发送数据 "),s("a",{staticClass:"header-anchor",attrs:{href:"#发送数据"}},[t._v("#")])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("deviceId在设备列表点击设备名称获取")]),t._v(" "),s("p",[t._v("pointId在设备详情->关联位号->点击位号名称获取")])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"deviceId"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1647845409185337346"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"pointId"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1647845983742070785"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"value"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"createTime"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2022-03-17 14:39:36"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"查看数据"}},[t._v("查看数据 "),s("a",{staticClass:"header-anchor",attrs:{href:"#查看数据"}},[t._v("#")])]),t._v(" "),s("p",[t._v("点击设备详情->设备数据,就能查看到刚才发送的数据")]),t._v(" "),s("p",[s("img",{attrs:{src:"/assets/images/operation/code/f350523c-d4cf-4626-94ea-bfc96dd4d3e0.png",alt:"设备数据"}})])],1)}),[],!1,null,null,null);s.default=i.exports}}]);